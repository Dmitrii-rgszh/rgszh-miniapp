{"ast":null,"code":"// src/CareFuturePage.js\nimport React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import logoImage from'./components/logo.png';import backgroundImage from'./components/background.png';import DateWheelPicker from'./DateWheelPicker';import'./CareFuturePage.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function CareFuturePage(){const navigate=useNavigate();// Стадии: 'email' → 'form' → 'processing' → 'result' → 'manager' → 'manager-sent'\nconst[stage,setStage]=useState('email');// ===== Состояния для Email-шага =====\nconst[email,setEmail]=useState('');const[emailError,setEmailError]=useState('');const emailValid=email.toLowerCase().endsWith('@vtb.ru');// ===== Состояния для формы расчёта =====\nconst[birthParts,setBirthParts]=useState({day:null,month:null,year:null});const[birthDate,setBirthDate]=useState(null);const[gender,setGender]=useState(null);// 'мужской' | 'женский'\nconst[programTerm,setProgramTerm]=useState(5);// срок программы в годах (5–20)\nconst[calcType,setCalcType]=useState(null);// 'premium' | 'sum'\nconst[amountRaw,setAmountRaw]=useState('');// «100000»\nconst[amountDisplay,setAmountDisplay]=useState('');// «100.000»\nconst[amountError,setAmountError]=useState('');// ===== Состояния Processing/Result =====\nconst[isProcessing,setIsProcessing]=useState(false);const[resultData,setResultData]=useState(null);const[carouselIndex,setCarouselIndex]=useState(0);// ===== Состояния для «Связаться с менеджером» =====\nconst[mgrSurname,setMgrSurname]=useState('');const[mgrName,setMgrName]=useState('');const[mgrCity,setMgrCity]=useState('');const[mgrError,setMgrError]=useState('');const[isSendingMgr,setIsSendingMgr]=useState(false);const[mgrSent,setMgrSent]=useState(false);// ===== HELPERS =====\n// Собираем Date-объект из birthParts\nuseEffect(()=>{const{day,month,year}=birthParts;if(day&&month&&year){const d=Number(day),m=Number(month),y=Number(year);const dt=new Date(y,m-1,d);if(!isNaN(dt.getTime())&&dt.getDate()===d&&dt.getMonth()+1===m&&dt.getFullYear()===y){setBirthDate(dt);}else{setBirthDate(null);}}else{setBirthDate(null);}},[birthParts]);// Вычисление возраста по дате рождения\nfunction getAge(d){if(!(d instanceof Date))return 0;const today=new Date();let age=today.getFullYear()-d.getFullYear();if(today.getMonth()<d.getMonth()||today.getMonth()===d.getMonth()&&today.getDate()<d.getDate()){age--;}return age;}// Формат суммы: «100000» → «100.000»\nfunction formatSum(rawString){const digits=rawString.replace(/\\D/g,'');if(!digits)return'';let s=digits,out='';while(s.length>3){out='.'+s.slice(-3)+out;s=s.slice(0,-3);}return s+out;}// Валидация формы «form»\nfunction canGoNextForm(){if(!birthDate)return false;if(!gender)return false;if(!calcType)return false;if(!amountRaw)return false;if(amountError)return false;const age=getAge(birthDate);if(age<18)return false;if(age+programTerm>70)return false;return true;}// ===== Обработчики =====\n// Шаг «email» → «form»\nfunction handleEmailNext(){if(!emailValid){setEmailError('Используйте корпоративную почту домена @vtb.ru');return;}setEmailError('');setStage('form');}// Изменение суммы: форматируем с «точками»\nfunction handleAmountChange(e){const raw=e.target.value.replace(/\\D/g,'');setAmountRaw(raw);const disp=formatSum(raw);setAmountDisplay(disp);const num=parseInt(raw,10)||0;if(num<100000){setAmountError('Введите сумму от 100 000 ₽');}else{setAmountError('');}}// Шаг «form» → отправка расчёта на сервер\nasync function handleFormNext(){if(!canGoNextForm())return;const dateRu=birthDate.toLocaleDateString('ru-RU',{day:'2-digit',month:'2-digit',year:'numeric'});const payload={email,birthdate:dateRu,age:getAge(birthDate),gender,term:programTerm,payment:calcType==='premium'?'Страхового взноса':'Страховой суммы',sum:parseInt(amountRaw,10)};setIsProcessing(true);setStage('processing');try{const res=await fetch('/api/proxy/carefuture/save',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(!res.ok){console.error('Ошибка расчёта:',res.status,await res.text());alert(`Ошибка расчёта: ${res.status}`);setIsProcessing(false);setStage('form');return;}const data=await res.json();/*\n        Ожидаем, что в data будут поля:\n          {\n            contribution: <годовой взнос пользователя>,\n            totalContribution: <годовой взнос * term>,\n            accrualPercent: <H12>,\n            accrualAmount: <H13>,\n            totalAccrual: <H16>,\n            finalAnnual: <M13>,\n            finalTotal: <M16>,\n            accumulation: <G13>,\n            totalDeduction: <C22 в рублях>,\n            delayedPayment: <G14 в рублях>\n          }\n      */setResultData(data);setCarouselIndex(0);setIsProcessing(false);setStage('result');}catch(err){console.error('Ошибка сети при расчёте:',err);alert('Не удалось выполнить расчёт');setIsProcessing(false);setStage('form');}}// Шаг «Отправка менеджеру»\nasync function handleManagerSubmit(){if(!mgrSurname.trim()||!mgrName.trim()||!mgrCity.trim()){setMgrError('Заполните, пожалуйста, все поля');return;}setMgrError('');setIsSendingMgr(true);const fullName=`${mgrSurname.trim()} ${mgrName.trim()}`;const subject=`Заявка на полис \"Забота о будущем\" - ${fullName}`;const bodyLines=['Добрый день, коллега!','','К Вам поступила заявка на полис \"Забота о будущем\".','',`ФИО сотрудника: ${fullName}`,`Пол: ${gender}`,`Дата рождения: ${birthDate.toLocaleDateString('ru-RU',{day:'2-digit',month:'2-digit',year:'numeric'})}`,`Возраст: ${getAge(birthDate)}`,`Почта сотрудника: ${email}`,`Город работы: ${mgrCity.trim()}`,'',`Срок программы: ${programTerm} лет`,`Сумма взноса: ${formatSum(String(resultData.contribution))} ₽`,`Периодичность оплаты: ежегодно`];const body=bodyLines.join('\\r\\n');const payload={subject,body};try{const res=await fetch('/api/proxy/carefuture/send_manager',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(!res.ok){console.error('Ошибка отправки менеджеру:',res.status,await res.text());setMgrError(`Ошибка отправки: ${res.status}`);setIsSendingMgr(false);}else{setIsSendingMgr(false);setMgrSent(true);setStage('manager-sent');// Через 4 секунды перенаправляем на главное меню\nsetTimeout(()=>navigate('/'),4000);}}catch(err){console.error('Ошибка сети при отправке менеджеру:',err);setMgrError('Не удалось отправить запрос менеджеру');setIsSendingMgr(false);}}// ===== Рендер разных экранов =====\n// --- «Выполняется расчёт…» (processing) ---\nif(stage==='processing'){return/*#__PURE__*/_jsxs(\"div\",{className:\"processing-screen\",style:{backgroundImage:`url(${backgroundImage})`},children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo-wrapper animate-logo\",children:/*#__PURE__*/_jsx(\"img\",{className:\"poll-logo\",src:logoImage,alt:\"\\u041B\\u043E\\u0433\\u043E\\u0442\\u0438\\u043F\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"processing-title\",children:\"\\u0412\\u044B\\u043F\\u043E\\u043B\\u043D\\u044F\\u0435\\u0442\\u0441\\u044F \\u0440\\u0430\\u0441\\u0447\\u0451\\u0442\\u2026\"}),/*#__PURE__*/_jsx(\"div\",{className:\"arrow-animation\",children:\"\\u2192\"})]});}// --- «Успешная отправка менеджеру» (manager-sent) ---\nif(stage==='manager-sent'&&mgrSent){const fullName=`${mgrSurname.trim()} ${mgrName.trim()}`;return/*#__PURE__*/_jsxs(\"div\",{className:\"processing-screen\",style:{backgroundImage:`url(${backgroundImage})`},children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo-wrapper animate-logo\",children:/*#__PURE__*/_jsx(\"img\",{className:\"poll-logo\",src:logoImage,alt:\"\\u041B\\u043E\\u0433\\u043E\\u0442\\u0438\\u043F\"})}),/*#__PURE__*/_jsxs(\"p\",{className:\"processing-title\",children:[fullName,\", \\u043D\\u0430\\u0448 \\u044D\\u043A\\u0441\\u043F\\u0435\\u0440\\u0442 \\u0441\\u0432\\u044F\\u0436\\u0435\\u0442\\u0441\\u044F \\u0441 \\u0412\\u0430\\u043C\\u0438 \\u0432 \\u0431\\u043B\\u0438\\u0436\\u0430\\u0439\\u0448\\u0435\\u0435 \\u0432\\u0440\\u0435\\u043C\\u044F!\",/*#__PURE__*/_jsx(\"br\",{}),\"\\u041E\\u0442\\u043B\\u0438\\u0447\\u043D\\u043E\\u0433\\u043E \\u0434\\u043D\\u044F, \\u043A\\u043E\\u043B\\u043B\\u0435\\u0433\\u0430!\"]})]});}// --- «Результаты расчёта» (result) ---\nif(stage==='result'&&resultData){return/*#__PURE__*/_jsxs(\"div\",{className:\"snp-container\",style:{backgroundImage:`url(${backgroundImage})`},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"polls-header\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-btn\",onClick:()=>navigate('/'),children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M3 11l9-8 9 8v10a1 1 0 0 1-1 1h-5v-7h-6v7H4a1 1 0 0 1-1-1V11z\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"logo-wrapper animate-logo\",children:/*#__PURE__*/_jsx(\"img\",{className:\"poll-logo\",src:logoImage,alt:\"\\u041B\\u043E\\u0433\\u043E\\u0442\\u0438\\u043F\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"repeat-btn\",onClick:()=>{setStage('form');setResultData(null);setGender(null);setCalcType(null);setAmountRaw('');setAmountDisplay('');setAmountError('');},children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M12 4V1L8 5l4 4V6 c4.41 0 8 3.59 8 8 s-3.59 8-8 8-8-3.59-8-8h2 c0 3.31 2.69 6 6 6s6-2.69 6-6 -2.69-6-6-6v3l-4-4 4-4z\",fill:\"#fff\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"content-wrapper\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"polls-title\",children:\"\\u0420\\u0435\\u0437\\u0443\\u043B\\u044C\\u0442\\u0430\\u0442\\u044B \\u0440\\u0430\\u0441\\u0447\\u0451\\u0442\\u0430 \\u043F\\u043E \\u043F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0435 \\\"\\u0417\\u0430\\u0431\\u043E\\u0442\\u0430 \\u043E \\u0431\\u0443\\u0434\\u0443\\u0449\\u0435\\u043C\\\"\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"params-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u041F\\u0430\\u0440\\u0430\\u043C\\u0435\\u0442\\u0440\\u044B\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0412\\u043E\\u0437\\u0440\\u0430\\u0441\\u0442: \",getAge(birthDate),\" \\u043B\\u0435\\u0442\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u041F\\u043E\\u043B: \",gender]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0421\\u0440\\u043E\\u043A: \",programTerm,\" \\u043B\\u0435\\u0442\"]}),/*#__PURE__*/_jsx(\"p\",{children:\"\\u041F\\u0435\\u0440\\u0438\\u043E\\u0434\\u0438\\u0447\\u043D\\u043E\\u0441\\u0442\\u044C \\u043E\\u043F\\u043B\\u0430\\u0442\\u044B: \\u0435\\u0436\\u0435\\u0433\\u043E\\u0434\\u043D\\u043E\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"carousel-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"carousel-indicators\",children:[/*#__PURE__*/_jsx(\"span\",{className:carouselIndex===0?'active':''}),/*#__PURE__*/_jsx(\"span\",{className:carouselIndex===1?'active':''}),/*#__PURE__*/_jsx(\"span\",{className:carouselIndex===2?'active':''})]}),/*#__PURE__*/_jsx(\"div\",{className:\"carousel-clipper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"carousel-wrapper\",style:{transform:`translateX(-${carouselIndex*100}%)`},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"carousel-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"first-line\",children:[\"\\u0412 \\u0442\\u0435\\u0447\\u0435\\u043D\\u0438\\u0435 \",programTerm,\" \\u043B\\u0435\\u0442\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"unit\",children:\"\\u0412\\u044B \\u0432\\u043D\\u043E\\u0441\\u0438\\u0442\\u0435 \\u0441\\u0440\\u0435\\u0434\\u0441\\u0442\\u0432\\u0430\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[formatSum(String(resultData.contribution)),\" \\u20BD\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"unit\",children:\"\\u0415\\u0436\\u0435\\u0433\\u043E\\u0434\\u043D\\u043E\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[formatSum(String(resultData.totalContribution)),\" \\u20BD\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"footer-label\",children:\"\\u0421\\u0443\\u043C\\u043C\\u0430 \\u0432\\u0430\\u0448\\u0438\\u0445 \\u0432\\u0437\\u043D\\u043E\\u0441\\u043E\\u0432\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"carousel-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"first-line\",children:\"\\u0412\\u044B \\u043D\\u0430\\u043A\\u043E\\u043F\\u0438\\u0442\\u0435\"}),/*#__PURE__*/_jsx(\"div\",{className:\"unit\",children:\"\\u0441 \\u0443\\u0447\\u0451\\u0442\\u043E\\u043C \\u0444\\u0438\\u043A\\u0441\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u043D\\u043E\\u0433\\u043E \\u0434\\u043E\\u0445\\u043E\\u0434\\u0430\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[formatSum(String(resultData.accumulation)),\" \\u20BD\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"unit\",children:\"\\u0441\\u0443\\u043C\\u043C\\u0430 \\u0432\\u044B\\u0447\\u0435\\u0442\\u0430 \\u0437\\u0430 \\u0432\\u0435\\u0441\\u044C \\u0441\\u0440\\u043E\\u043A\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[formatSum(String(resultData.totalDeduction)),\" \\u20BD\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"footer-label\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"carousel-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"first-line\",children:\"\\u0424\\u0438\\u043D\\u0430\\u043D\\u0441\\u043E\\u0432\\u0430\\u044F \\u0437\\u0430\\u0449\\u0438\\u0442\\u0430\"}),/*#__PURE__*/_jsx(\"div\",{className:\"unit\",children:\"\\u0423\\u0445\\u043E\\u0434 \\u0438\\u0437 \\u0436\\u0438\\u0437\\u043D\\u0438 (\\u043B\\u044E\\u0431\\u0430\\u044F \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430) \\u2013 \\u043E\\u0442\\u043B\\u043E\\u0436\\u0435\\u043D\\u043D\\u0430\\u044F \\u0432\\u044B\\u043F\\u043B\\u0430\\u0442\\u0430\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[formatSum(String(resultData.delayedPayment)),\" \\u20BD\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"unit\",children:\"\\u0423\\u0445\\u043E\\u0434 \\u0438\\u0437 \\u0436\\u0438\\u0437\\u043D\\u0438 (\\u043B\\u044E\\u0431\\u0430\\u044F \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430) \\u2013 \\u0435\\u0434\\u0438\\u043D\\u043E\\u0432\\u0440\\u0435\\u043C\\u0435\\u043D\\u043D\\u0430\\u044F \\u0432\\u044B\\u043F\\u043B\\u0430\\u0442\\u0430\"}),/*#__PURE__*/_jsx(\"div\",{className:\"value\",children:\"100% \\u0441\\u043E\\u0432\\u0435\\u0440\\u0448\\u0435\\u043D\\u043D\\u044B\\u0445 \\u0432\\u0437\\u043D\\u043E\\u0441\\u043E\\u0432\"}),/*#__PURE__*/_jsx(\"div\",{className:\"footer-label\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"carousel-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"first-line\",children:\"\\u0424\\u0438\\u043D\\u0430\\u043D\\u0441\\u043E\\u0432\\u0430\\u044F \\u0437\\u0430\\u0449\\u0438\\u0442\\u0430\"}),/*#__PURE__*/_jsx(\"div\",{className:\"unit\",children:\"\\u0423\\u0441\\u0442\\u0430\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D\\u0438\\u0435 \\u0438\\u043D\\u0432\\u0430\\u043B\\u0438\\u0434\\u043D\\u043E\\u0441\\u0442\\u0438 I,II \\u0433\\u0440\\u0443\\u043F\\u043F\\u044B \\u043F\\u043E \\u043B\\u044E\\u0431\\u043E\\u0439 \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0435\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[formatSum(String(resultData.delayedPayment)),\" \\u20BD\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"unit\",children:\"\\u0423\\u0445\\u043E\\u0434 \\u0438\\u0437 \\u0436\\u0438\\u0437\\u043D\\u0438 (\\u043B\\u044E\\u0431\\u0430\\u044F \\u043F\\u0440\\u0438\\u0447\\u0438\\u043D\\u0430) \\u2013 \\u0435\\u0434\\u0438\\u043D\\u043E\\u0432\\u0440\\u0435\\u043C\\u0435\\u043D\\u043D\\u0430\\u044F \\u0432\\u044B\\u043F\\u043B\\u0430\\u0442\\u0430\"}),/*#__PURE__*/_jsx(\"div\",{className:\"value\",children:\"100% \\u0441\\u043E\\u0432\\u0435\\u0440\\u0448\\u0435\\u043D\\u043D\\u044B\\u0445 \\u0432\\u0437\\u043D\\u043E\\u0441\\u043E\\u0432\"}),/*#__PURE__*/_jsx(\"div\",{className:\"footer-label\"})]})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"carousel-control prev\",onClick:()=>setCarouselIndex(idx=>idx-1),disabled:carouselIndex===0,children:\"\\u2039\"}),/*#__PURE__*/_jsx(\"button\",{className:\"carousel-control next\",onClick:()=>setCarouselIndex(idx=>idx+1),disabled:carouselIndex===2,children:\"\\u203A\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"contact-btn\",onClick:()=>setStage('manager'),children:\"\\u0421\\u0432\\u044F\\u0437\\u0430\\u0442\\u044C\\u0441\\u044F \\u0441 \\u043C\\u0435\\u043D\\u0435\\u0434\\u0436\\u0435\\u0440\\u043E\\u043C\"})]})]});}// --- Экран «Email» (stage='email') ---\nif(stage==='email'){return/*#__PURE__*/_jsxs(\"div\",{className:\"snp-container\",style:{backgroundImage:`url(${backgroundImage})`},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"polls-header\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-btn\",onClick:()=>navigate('/'),children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M3 11l9-8 9 8v10a1 1 0 0 1-1 1h-5v-7h-6v7H4a1 1 0 0 1-1-1V11z\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"logo-wrapper animate-logo\",children:/*#__PURE__*/_jsx(\"img\",{className:\"poll-logo\",src:logoImage,alt:\"\\u041B\\u043E\\u0433\\u043E\\u0442\\u0438\\u043F\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"forward-btn\",onClick:handleEmailNext,disabled:!emailValid,children:/*#__PURE__*/_jsx(\"span\",{className:\"arrow-icon\",children:\"\\u2192\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"content-wrapper\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"polls-title\",children:\"\\u0417\\u0430\\u0431\\u043E\\u0442\\u0430 \\u043E \\u0431\\u0443\\u0434\\u0443\\u0449\\u043D\\u0435\\u043C\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"email-step\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"email-label\",children:\"\\u041A\\u043E\\u0440\\u043F\\u043E\\u0440\\u0430\\u0442\\u0438\\u0432\\u043D\\u0430\\u044F \\u043F\\u043E\\u0447\\u0442\\u0430 \\u0412\\u0422\\u0411:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",inputMode:\"email\",autoComplete:\"email\",autoCapitalize:\"none\",spellCheck:\"false\",placeholder:\"name@vtb.ru\",value:email,onChange:e=>setEmail(e.target.value)})]}),emailError&&/*#__PURE__*/_jsx(\"div\",{className:\"input-error\",children:emailError}),/*#__PURE__*/_jsx(\"button\",{className:\"polls-btn\",onClick:handleEmailNext,disabled:!emailValid,children:\"\\u041F\\u0440\\u043E\\u0434\\u043E\\u043B\\u0436\\u0438\\u0442\\u044C\"})]})]});}// --- Экран «Form» (stage='form') ---\nif(stage==='form'){return/*#__PURE__*/_jsxs(\"div\",{className:\"snp-container\",style:{backgroundImage:`url(${backgroundImage})`},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"polls-header\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-btn\",onClick:()=>setStage('email'),children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M3 11l9-8 9 8v10a1 1 0 0 1-1 1h-5v-7h-6v7H4a1 1 0 0 1-1-1V11z\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"logo-wrapper animate-logo\",children:/*#__PURE__*/_jsx(\"img\",{className:\"poll-logo\",src:logoImage,alt:\"\\u041B\\u043E\\u0433\\u043E\\u0442\\u0438\\u043F\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"forward-btn\",onClick:handleFormNext,disabled:!canGoNextForm(),children:/*#__PURE__*/_jsx(\"span\",{className:\"arrow-icon\",children:\"\\u2192\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"content-wrapper\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"polls-title\",children:\"\\u0417\\u0430\\u0431\\u043E\\u0442\\u0430 \\u043E \\u0431\\u0443\\u0434\\u0443\\u0449\\u0435\\u043C\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"date-section\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"section-label\",children:\"\\u0414\\u0430\\u0442\\u0430 \\u0440\\u043E\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F:\"}),/*#__PURE__*/_jsx(DateWheelPicker,{value:birthParts,onChange:val=>{if(val instanceof Date){setBirthParts({day:String(val.getDate()).padStart(2,'0'),month:String(val.getMonth()+1).padStart(2,'0'),year:String(val.getFullYear())});}else if(typeof val==='object'){setBirthParts(prev=>({...prev,...(val.day!=null?{day:String(val.day).padStart(2,'0')}:{}),...(val.month!=null?{month:String(val.month).padStart(2,'0')}:{}),...(val.year!=null?{year:String(val.year)}:{})}));}}})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"date-section\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"section-label\",children:\"\\u0421\\u0440\\u043E\\u043A \\u043F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u044B (\\u043B\\u0435\\u0442):\"}),/*#__PURE__*/_jsx(\"select\",{className:\"date-picker-select\",value:programTerm,onChange:e=>setProgramTerm(Number(e.target.value)),children:Array.from({length:16},(_,i)=>5+i).map(v=>/*#__PURE__*/_jsxs(\"option\",{value:v,children:[v,\" \\u043B\\u0435\\u0442\"]},v))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"section-subtitle\",children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043F\\u043E\\u043B:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"gender-section\",children:[/*#__PURE__*/_jsxs(\"button\",{className:`insurance-btn ${gender==='мужской'?'selected':''}`,onClick:()=>setGender('мужской'),children:[/*#__PURE__*/_jsx(\"div\",{children:\"\\u041C\\u0443\\u0436\\u0441\\u043A\\u043E\\u0439\"}),/*#__PURE__*/_jsx(\"div\",{className:\"emoji\",children:\"\\uD83D\\uDC68\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:`insurance-btn ${gender==='женский'?'selected':''}`,onClick:()=>setGender('женский'),children:[/*#__PURE__*/_jsx(\"div\",{children:\"\\u0416\\u0435\\u043D\\u0441\\u043A\\u0438\\u0439\"}),/*#__PURE__*/_jsx(\"div\",{className:\"emoji\",children:\"\\uD83D\\uDC69\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"section-subtitle\",children:\"\\u0420\\u0430\\u0441\\u0447\\u0451\\u0442 \\u043E\\u0442\\u2026\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"insurance-options\",children:[/*#__PURE__*/_jsxs(\"button\",{className:`insurance-btn ${calcType==='premium'?'selected':''}`,onClick:()=>{setCalcType('premium');setAmountRaw('');setAmountDisplay('');setAmountError('');},children:[/*#__PURE__*/_jsx(\"div\",{children:\"\\u0421\\u0442\\u0440\\u0430\\u0445\\u043E\\u0432\\u043E\\u0433\\u043E\"}),/*#__PURE__*/_jsx(\"div\",{children:\"\\u0432\\u0437\\u043D\\u043E\\u0441\\u0430\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:`insurance-btn ${calcType==='sum'?'selected':''}`,onClick:()=>{setCalcType('sum');setAmountRaw('');setAmountDisplay('');setAmountError('');},children:[/*#__PURE__*/_jsx(\"div\",{children:\"\\u0421\\u0442\\u0440\\u0430\\u0445\\u043E\\u0432\\u043E\\u0439\"}),/*#__PURE__*/_jsx(\"div\",{children:\"\\u0441\\u0443\\u043C\\u043C\\u044B\"})]})]}),calcType&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"section-subtitle\",children:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0441\\u0443\\u043C\\u043C\\u0443 \\u0432 \\u0440\\u0443\\u0431\\u043B\\u044F\\u0445:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"sum-section\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u041C\\u0438\\u043D. 100 000\",value:amountDisplay,onChange:handleAmountChange})}),amountError&&/*#__PURE__*/_jsx(\"div\",{className:\"input-error\",children:amountError})]})]})]});}// --- Экран «Связаться с менеджером» (stage='manager') ---\nif(stage==='manager'){return/*#__PURE__*/_jsxs(\"div\",{className:\"snp-container\",style:{backgroundImage:`url(${backgroundImage})`},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"polls-header\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-btn\",onClick:()=>setStage('result'),children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M3 11l9-8 9 8v10a1 1 0 0 1-1 1h-5v-7h-6v7H4a1 1 0 0 1-1-1V11z\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"logo-wrapper animate-logo\",children:/*#__PURE__*/_jsx(\"img\",{className:\"poll-logo\",src:logoImage,alt:\"\\u041B\\u043E\\u0433\\u043E\\u0442\\u0438\\u043F\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"content-wrapper\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"contact-title\",children:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0412\\u0430\\u0448\\u0438 \\u0434\\u0430\\u043D\\u043D\\u044B\\u0435:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"contact-form\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"\\u0424\\u0430\\u043C\\u0438\\u043B\\u0438\\u044F:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0444\\u0430\\u043C\\u0438\\u043B\\u0438\\u044E\",value:mgrSurname,onChange:e=>setMgrSurname(e.target.value)}),/*#__PURE__*/_jsx(\"label\",{children:\"\\u0418\\u043C\\u044F:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0438\\u043C\\u044F\",value:mgrName,onChange:e=>setMgrName(e.target.value)}),/*#__PURE__*/_jsx(\"label\",{children:\"\\u0413\\u043E\\u0440\\u043E\\u0434 \\u0440\\u0430\\u0431\\u043E\\u0442\\u044B:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"\\u0412\\u0432\\u0435\\u0434\\u0438\\u0442\\u0435 \\u0433\\u043E\\u0440\\u043E\\u0434\",value:mgrCity,onChange:e=>setMgrCity(e.target.value)})]}),mgrError&&/*#__PURE__*/_jsx(\"div\",{className:\"input-error\",children:mgrError}),/*#__PURE__*/_jsx(\"button\",{className:\"contact-btn\",onClick:handleManagerSubmit,disabled:isSendingMgr,children:\"\\u041E\\u0442\\u043F\\u0440\\u0430\\u0432\\u0438\\u0442\\u044C \\u0437\\u0430\\u043F\\u0440\\u043E\\u0441\"})]})]});}// Если ни одна стадия не подошла — null\nreturn null;}","map":{"version":3,"names":["React","useState","useEffect","useNavigate","logoImage","backgroundImage","DateWheelPicker","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CareFuturePage","navigate","stage","setStage","email","setEmail","emailError","setEmailError","emailValid","toLowerCase","endsWith","birthParts","setBirthParts","day","month","year","birthDate","setBirthDate","gender","setGender","programTerm","setProgramTerm","calcType","setCalcType","amountRaw","setAmountRaw","amountDisplay","setAmountDisplay","amountError","setAmountError","isProcessing","setIsProcessing","resultData","setResultData","carouselIndex","setCarouselIndex","mgrSurname","setMgrSurname","mgrName","setMgrName","mgrCity","setMgrCity","mgrError","setMgrError","isSendingMgr","setIsSendingMgr","mgrSent","setMgrSent","d","Number","m","y","dt","Date","isNaN","getTime","getDate","getMonth","getFullYear","getAge","today","age","formatSum","rawString","digits","replace","s","out","length","slice","canGoNextForm","handleEmailNext","handleAmountChange","e","raw","target","value","disp","num","parseInt","handleFormNext","dateRu","toLocaleDateString","payload","birthdate","term","payment","sum","res","fetch","method","headers","body","JSON","stringify","ok","console","error","status","text","alert","data","json","err","handleManagerSubmit","trim","fullName","subject","bodyLines","String","contribution","join","setTimeout","className","style","children","src","alt","onClick","viewBox","fill","transform","totalContribution","accumulation","totalDeduction","delayedPayment","idx","disabled","type","inputMode","autoComplete","autoCapitalize","spellCheck","placeholder","onChange","val","padStart","prev","Array","from","_","i","map","v"],"sources":["C:/Users/shapeless/Desktop/miniapp/src/CareFuturePage.js"],"sourcesContent":["// src/CareFuturePage.js\n\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\nimport logoImage       from './components/logo.png';\nimport backgroundImage from './components/background.png';\nimport DateWheelPicker from './DateWheelPicker';\n\nimport './CareFuturePage.css';\n\nexport default function CareFuturePage() {\n  const navigate = useNavigate();\n\n  // Стадии: 'email' → 'form' → 'processing' → 'result' → 'manager' → 'manager-sent'\n  const [stage, setStage] = useState('email');\n\n  // ===== Состояния для Email-шага =====\n  const [email, setEmail]         = useState('');\n  const [emailError, setEmailError] = useState('');\n  const emailValid = email.toLowerCase().endsWith('@vtb.ru');\n\n  // ===== Состояния для формы расчёта =====\n  const [birthParts, setBirthParts] = useState({\n    day: null,\n    month: null,\n    year: null\n  });\n  const [birthDate, setBirthDate]   = useState(null);\n  const [gender, setGender]         = useState(null);         // 'мужской' | 'женский'\n  const [programTerm, setProgramTerm] = useState(5);           // срок программы в годах (5–20)\n  const [calcType, setCalcType]     = useState(null);         // 'premium' | 'sum'\n  const [amountRaw, setAmountRaw]   = useState('');           // «100000»\n  const [amountDisplay, setAmountDisplay] = useState('');     // «100.000»\n  const [amountError, setAmountError]     = useState('');\n\n  // ===== Состояния Processing/Result =====\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [resultData, setResultData]     = useState(null);\n  const [carouselIndex, setCarouselIndex] = useState(0);\n\n  // ===== Состояния для «Связаться с менеджером» =====\n  const [mgrSurname, setMgrSurname]    = useState('');\n  const [mgrName, setMgrName]          = useState('');\n  const [mgrCity, setMgrCity]          = useState('');\n  const [mgrError, setMgrError]        = useState('');\n  const [isSendingMgr, setIsSendingMgr]  = useState(false);\n  const [mgrSent, setMgrSent]            = useState(false);\n\n  // ===== HELPERS =====\n\n  // Собираем Date-объект из birthParts\n  useEffect(() => {\n    const { day, month, year } = birthParts;\n    if (day && month && year) {\n      const d = Number(day), m = Number(month), y = Number(year);\n      const dt = new Date(y, m - 1, d);\n      if (\n        !isNaN(dt.getTime()) &&\n        dt.getDate() === d &&\n        dt.getMonth() + 1 === m &&\n        dt.getFullYear() === y\n      ) {\n        setBirthDate(dt);\n      } else {\n        setBirthDate(null);\n      }\n    } else {\n      setBirthDate(null);\n    }\n  }, [birthParts]);\n\n  // Вычисление возраста по дате рождения\n  function getAge(d) {\n    if (!(d instanceof Date)) return 0;\n    const today = new Date();\n    let age = today.getFullYear() - d.getFullYear();\n    if (\n      today.getMonth() < d.getMonth() ||\n      (today.getMonth() === d.getMonth() && today.getDate() < d.getDate())\n    ) {\n      age--;\n    }\n    return age;\n  }\n\n  // Формат суммы: «100000» → «100.000»\n  function formatSum(rawString) {\n    const digits = rawString.replace(/\\D/g, '');\n    if (!digits) return '';\n    let s = digits, out = '';\n    while (s.length > 3) {\n      out = '.' + s.slice(-3) + out;\n      s = s.slice(0, -3);\n    }\n    return s + out;\n  }\n\n  // Валидация формы «form»\n  function canGoNextForm() {\n    if (!birthDate) return false;\n    if (!gender) return false;\n    if (!calcType) return false;\n    if (!amountRaw) return false;\n    if (amountError) return false;\n\n    const age = getAge(birthDate);\n    if (age < 18) return false;\n    if (age + programTerm > 70) return false;\n    return true;\n  }\n\n  // ===== Обработчики =====\n\n  // Шаг «email» → «form»\n  function handleEmailNext() {\n    if (!emailValid) {\n      setEmailError('Используйте корпоративную почту домена @vtb.ru');\n      return;\n    }\n    setEmailError('');\n    setStage('form');\n  }\n\n  // Изменение суммы: форматируем с «точками»\n  function handleAmountChange(e) {\n    const raw = e.target.value.replace(/\\D/g, '');\n    setAmountRaw(raw);\n    const disp = formatSum(raw);\n    setAmountDisplay(disp);\n\n    const num = parseInt(raw, 10) || 0;\n    if (num < 100000) {\n      setAmountError('Введите сумму от 100 000 ₽');\n    } else {\n      setAmountError('');\n    }\n  }\n\n  // Шаг «form» → отправка расчёта на сервер\n  async function handleFormNext() {\n    if (!canGoNextForm()) return;\n\n    const dateRu = birthDate.toLocaleDateString('ru-RU', {\n      day: '2-digit',\n      month: '2-digit',\n      year: 'numeric'\n    });\n    const payload = {\n      email,\n      birthdate: dateRu,\n      age:        getAge(birthDate),\n      gender,\n      term:       programTerm,\n      payment:    calcType === 'premium' ? 'Страхового взноса' : 'Страховой суммы',\n      sum:        parseInt(amountRaw, 10)\n    };\n\n    setIsProcessing(true);\n    setStage('processing');\n\n    try {\n      const res = await fetch('/api/proxy/carefuture/save', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload)\n      });\n      if (!res.ok) {\n        console.error('Ошибка расчёта:', res.status, await res.text());\n        alert(`Ошибка расчёта: ${res.status}`);\n        setIsProcessing(false);\n        setStage('form');\n        return;\n      }\n\n      const data = await res.json();\n      /*\n        Ожидаем, что в data будут поля:\n          {\n            contribution: <годовой взнос пользователя>,\n            totalContribution: <годовой взнос * term>,\n            accrualPercent: <H12>,\n            accrualAmount: <H13>,\n            totalAccrual: <H16>,\n            finalAnnual: <M13>,\n            finalTotal: <M16>,\n            accumulation: <G13>,\n            totalDeduction: <C22 в рублях>,\n            delayedPayment: <G14 в рублях>\n          }\n      */\n      setResultData(data);\n      setCarouselIndex(0);\n      setIsProcessing(false);\n      setStage('result');\n    } catch (err) {\n      console.error('Ошибка сети при расчёте:', err);\n      alert('Не удалось выполнить расчёт');\n      setIsProcessing(false);\n      setStage('form');\n    }\n  }\n\n  // Шаг «Отправка менеджеру»\n  async function handleManagerSubmit() {\n    if (!mgrSurname.trim() || !mgrName.trim() || !mgrCity.trim()) {\n      setMgrError('Заполните, пожалуйста, все поля');\n      return;\n    }\n    setMgrError('');\n    setIsSendingMgr(true);\n\n    const fullName = `${mgrSurname.trim()} ${mgrName.trim()}`;\n    const subject = `Заявка на полис \"Забота о будущем\" - ${fullName}`;\n    const bodyLines = [\n      'Добрый день, коллега!',\n      '',\n      'К Вам поступила заявка на полис \"Забота о будущем\".',\n      '',\n      `ФИО сотрудника: ${fullName}`,\n      `Пол: ${gender}`,\n      `Дата рождения: ${birthDate.toLocaleDateString('ru-RU', { day:'2-digit', month:'2-digit', year:'numeric' })}`,\n      `Возраст: ${getAge(birthDate)}`,\n      `Почта сотрудника: ${email}`,\n      `Город работы: ${mgrCity.trim()}`,\n      '',\n      `Срок программы: ${programTerm} лет`,\n      `Сумма взноса: ${formatSum(String(resultData.contribution))} ₽`,\n      `Периодичность оплаты: ежегодно`\n    ];\n    const body = bodyLines.join('\\r\\n');\n\n    const payload = { subject, body };\n\n    try {\n      const res = await fetch('/api/proxy/carefuture/send_manager', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify(payload)\n      });\n      if (!res.ok) {\n        console.error('Ошибка отправки менеджеру:', res.status, await res.text());\n        setMgrError(`Ошибка отправки: ${res.status}`);\n        setIsSendingMgr(false);\n      } else {\n        setIsSendingMgr(false);\n        setMgrSent(true);\n        setStage('manager-sent');\n        // Через 4 секунды перенаправляем на главное меню\n        setTimeout(() => navigate('/'), 4000);\n      }\n    } catch (err) {\n      console.error('Ошибка сети при отправке менеджеру:', err);\n      setMgrError('Не удалось отправить запрос менеджеру');\n      setIsSendingMgr(false);\n    }\n  }\n\n  // ===== Рендер разных экранов =====\n\n  // --- «Выполняется расчёт…» (processing) ---\n  if (stage === 'processing') {\n    return (\n      <div\n        className=\"processing-screen\"\n        style={{ backgroundImage: `url(${backgroundImage})` }}\n      >\n        <div className=\"logo-wrapper animate-logo\">\n          <img className=\"poll-logo\" src={logoImage} alt=\"Логотип\" />\n        </div>\n        <p className=\"processing-title\">Выполняется расчёт…</p>\n        <div className=\"arrow-animation\">→</div>\n      </div>\n    );\n  }\n\n  // --- «Успешная отправка менеджеру» (manager-sent) ---\n  if (stage === 'manager-sent' && mgrSent) {\n    const fullName = `${mgrSurname.trim()} ${mgrName.trim()}`;\n    return (\n      <div\n        className=\"processing-screen\"\n        style={{ backgroundImage: `url(${backgroundImage})` }}\n      >\n        <div className=\"logo-wrapper animate-logo\">\n          <img className=\"poll-logo\" src={logoImage} alt=\"Логотип\" />\n        </div>\n        <p className=\"processing-title\">\n          {fullName}, наш эксперт свяжется с Вами в ближайшее время!<br />\n          Отличного дня, коллега!\n        </p>\n      </div>\n    );\n  }\n\n  // --- «Результаты расчёта» (result) ---\n  if (stage === 'result' && resultData) {\n    return (\n      <div\n        className=\"snp-container\"\n        style={{ backgroundImage: `url(${backgroundImage})` }}\n      >\n        <div className=\"polls-header\">\n          {/* Кнопка «Домой» */}\n          <button className=\"back-btn\" onClick={() => navigate('/')}>\n            <svg viewBox=\"0 0 24 24\">\n              <path d=\"M3 11l9-8 9 8v10a1 1 0 0 1-1 1h-5v-7h-6v7H4a1 1 0 0 1-1-1V11z\" />\n            </svg>\n          </button>\n\n          <div className=\"logo-wrapper animate-logo\">\n            <img className=\"poll-logo\" src={logoImage} alt=\"Логотип\" />\n          </div>\n\n          {/* Кнопка «Повторить расчёт» (сброс к форме) */}\n          <button\n            className=\"repeat-btn\"\n            onClick={() => {\n              setStage('form');\n              setResultData(null);\n              setGender(null);\n              setCalcType(null);\n              setAmountRaw('');\n              setAmountDisplay('');\n              setAmountError('');\n            }}\n          >\n            <svg viewBox=\"0 0 24 24\">\n              <path\n                d=\"M12 4V1L8 5l4 4V6\n                   c4.41 0 8 3.59 8 8\n                   s-3.59 8-8 8-8-3.59-8-8h2\n                   c0 3.31 2.69 6 6 6s6-2.69 6-6\n                   -2.69-6-6-6v3l-4-4 4-4z\"\n                fill=\"#fff\"\n              />\n            </svg>\n          </button>\n        </div>\n\n        <div className=\"content-wrapper\">\n          <h1 className=\"polls-title\">\n            Результаты расчёта по программе \"Забота о будущем\"\n          </h1>\n\n          {/* Блок «Параметры» */}\n          <div className=\"params-container\">\n            <h2>Параметры</h2>\n            <p>Возраст: {getAge(birthDate)} лет</p>\n            <p>Пол: {gender}</p>\n            <p>Срок: {programTerm} лет</p>\n            <p>Периодичность оплаты: ежегодно</p>\n          </div>\n\n          {/* КАРУСЕЛЬ */}\n          <div className=\"carousel-container\">\n            {/* Индикаторы (три точки) */}\n            <div className=\"carousel-indicators\">\n              <span className={carouselIndex === 0 ? 'active' : ''}></span>\n              <span className={carouselIndex === 1 ? 'active' : ''}></span>\n              <span className={carouselIndex === 2 ? 'active' : ''}></span>\n            </div>\n\n            {/* «Обрезающее окно» */}\n            <div className=\"carousel-clipper\">\n              <div\n                className=\"carousel-wrapper\"\n                style={{ transform: `translateX(-${carouselIndex * 100}%)` }}\n              >\n                {/* 1-я страница: «Сумма Ваших взносов» */}\n                <div className=\"carousel-page\">\n                  <div className=\"first-line\">\n                    В течение {programTerm} лет\n                  </div>\n                  <div className=\"unit\">Вы вносите средства</div>\n                  <div className=\"value\">\n                    {formatSum(String(resultData.contribution))} ₽\n                  </div>\n                  <div className=\"unit\">Ежегодно</div>\n                  <div className=\"value\">\n                    {formatSum(String(resultData.totalContribution))} ₽\n                  </div>\n                  <div className=\"footer-label\">Сумма ваших взносов</div>\n                </div>\n\n                {/* 2-я страница: «Вы накопите» */}\n                <div className=\"carousel-page\">\n                  <div className=\"first-line\">Вы накопите</div>\n                  <div className=\"unit\">с учётом фиксированного дохода</div>\n                  <div className=\"value\">\n                    {formatSum(String(resultData.accumulation))} ₽\n                  </div>\n                  <div className=\"unit\">сумма вычета за весь срок</div>\n                  <div className=\"value\">\n                    {formatSum(String(resultData.totalDeduction))} ₽\n                  </div>\n                  <div className=\"footer-label\"></div>\n                </div>\n\n                {/* 3-я страница: «Финансовая защита» */}\n                <div className=\"carousel-page\">\n                  <div className=\"first-line\">Финансовая защита</div>\n                  <div className=\"unit\">\n                    Уход из жизни (любая причина) – отложенная выплата\n                  </div>\n                  <div className=\"value\">\n                    {formatSum(String(resultData.delayedPayment))} ₽\n                  </div>\n                  <div className=\"unit\">\n                    Уход из жизни (любая причина) – единовременная выплата\n                  </div>\n                  <div className=\"value\">100% совершенных взносов</div>\n                  <div className=\"footer-label\"></div>\n                </div>\n\n                {/* 4-я страница: «Финансовая защита» */}\n                <div className=\"carousel-page\">\n                  <div className=\"first-line\">Финансовая защита</div>\n                  <div className=\"unit\">\n                    Установление инвалидности I,II группы по любой причине\n                  </div>\n                  <div className=\"value\">\n                    {formatSum(String(resultData.delayedPayment))} ₽\n                  </div>\n                  <div className=\"unit\">\n                    Уход из жизни (любая причина) – единовременная выплата\n                  </div>\n                  <div className=\"value\">100% совершенных взносов</div>\n                  <div className=\"footer-label\"></div>\n                </div>\n              </div>\n            </div>\n\n            {/* Кнопки перехода карусели */}\n            <button\n              className=\"carousel-control prev\"\n              onClick={() => setCarouselIndex(idx => idx - 1)}\n              disabled={carouselIndex === 0}\n            >\n              ‹\n            </button>\n            <button\n              className=\"carousel-control next\"\n              onClick={() => setCarouselIndex(idx => idx + 1)}\n              disabled={carouselIndex === 2}\n            >\n              ›\n            </button>\n          </div>\n\n          {/* Кнопка «Связаться с менеджером» */}\n          <button\n            className=\"contact-btn\"\n            onClick={() => setStage('manager')}\n          >\n            Связаться с менеджером\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // --- Экран «Email» (stage='email') ---\n  if (stage === 'email') {\n    return (\n      <div\n        className=\"snp-container\"\n        style={{ backgroundImage: `url(${backgroundImage})` }}\n      >\n        <div className=\"polls-header\">\n          {/* Домой */}\n          <button className=\"back-btn\" onClick={() => navigate('/')}>\n            <svg viewBox=\"0 0 24 24\">\n              <path d=\"M3 11l9-8 9 8v10a1 1 0 0 1-1 1h-5v-7h-6v7H4a1 1 0 0 1-1-1V11z\" />\n            </svg>\n          </button>\n          {/* Логотип */}\n          <div className=\"logo-wrapper animate-logo\">\n            <img className=\"poll-logo\" src={logoImage} alt=\"Логотип\" />\n          </div>\n          {/* Кнопка «Далее» (активна при валидном email) */}\n          <button\n            className=\"forward-btn\"\n            onClick={handleEmailNext}\n            disabled={!emailValid}\n          >\n            <span className=\"arrow-icon\">→</span>\n          </button>\n        </div>\n\n        <div className=\"content-wrapper\">\n          <h1 className=\"polls-title\">Забота о будущнем</h1>\n          <div className=\"email-step\">\n            <label className=\"email-label\">Корпоративная почта ВТБ:</label>\n            <input\n              type=\"email\"\n              inputMode=\"email\"\n              autoComplete=\"email\"\n              autoCapitalize=\"none\"\n              spellCheck=\"false\"\n              placeholder=\"name@vtb.ru\"\n              value={email}\n              onChange={e => setEmail(e.target.value)}\n            />\n          </div>\n          {emailError && <div className=\"input-error\">{emailError}</div>}\n\n          <button\n            className=\"polls-btn\"\n            onClick={handleEmailNext}\n            disabled={!emailValid}\n          >\n            Продолжить\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // --- Экран «Form» (stage='form') ---\n  if (stage === 'form') {\n    return (\n      <div\n        className=\"snp-container\"\n        style={{ backgroundImage: `url(${backgroundImage})` }}\n      >\n        <div className=\"polls-header\">\n          {/* Кнопка «Назад» (возвращает на email) */}\n          <button className=\"back-btn\" onClick={() => setStage('email')}>\n            <svg viewBox=\"0 0 24 24\">\n              <path d=\"M3 11l9-8 9 8v10a1 1 0 0 1-1 1h-5v-7h-6v7H4a1 1 0 0 1-1-1V11z\" />\n            </svg>\n          </button>\n          {/* Логотип */}\n          <div className=\"logo-wrapper animate-logo\">\n            <img className=\"poll-logo\" src={logoImage} alt=\"Логотип\" />\n          </div>\n          {/* Кнопка «Далее» отображается, если форма заполнена корректно */}\n          <button\n            className=\"forward-btn\"\n            onClick={handleFormNext}\n            disabled={!canGoNextForm()}\n          >\n            <span className=\"arrow-icon\">→</span>\n          </button>\n        </div>\n\n        <div className=\"content-wrapper\">\n          <h1 className=\"polls-title\">Забота о будущем</h1>\n\n          {/* Выбор даты рождения */}\n          <div className=\"date-section\">\n            <label className=\"section-label\">Дата рождения:</label>\n            <DateWheelPicker\n              value={birthParts}\n              onChange={val => {\n                if (val instanceof Date) {\n                  setBirthParts({\n                    day: String(val.getDate()).padStart(2, '0'),\n                    month: String(val.getMonth() + 1).padStart(2, '0'),\n                    year: String(val.getFullYear())\n                  });\n                } else if (typeof val === 'object') {\n                  setBirthParts(prev => ({\n                    ...prev,\n                    ...(val.day   != null ? { day: String(val.day).padStart(2, '0') } : {}),\n                    ...(val.month != null ? { month: String(val.month).padStart(2, '0') } : {}),\n                    ...(val.year  != null ? { year: String(val.year) }                   : {})\n                  }));\n                }\n              }}\n            />\n          </div>\n\n          {/* Выбор срока программы */}\n          <div className=\"date-section\">\n            <label className=\"section-label\">Срок программы (лет):</label>\n            <select\n              className=\"date-picker-select\"\n              value={programTerm}\n              onChange={e => setProgramTerm(Number(e.target.value))}\n            >\n              {Array.from({ length: 16 }, (_, i) => 5 + i).map(v => (\n                <option key={v} value={v}>\n                  {v} лет\n                </option>\n              ))}\n            </select>\n          </div>\n\n          {/* Выбор пола */}\n          <div className=\"section-subtitle\">Выберите пол:</div>\n          <div className=\"gender-section\">\n            <button\n              className={`insurance-btn ${gender === 'мужской' ? 'selected' : ''}`}\n              onClick={() => setGender('мужской')}\n            >\n              <div>Мужской</div>\n              <div className=\"emoji\">👨</div>\n            </button>\n            <button\n              className={`insurance-btn ${gender === 'женский' ? 'selected' : ''}`}\n              onClick={() => setGender('женский')}\n            >\n              <div>Женский</div>\n              <div className=\"emoji\">👩</div>\n            </button>\n          </div>\n\n          {/* Выбор, от чего расчёт */}\n          <div className=\"section-subtitle\">Расчёт от…</div>\n          <div className=\"insurance-options\">\n            <button\n              className={`insurance-btn ${calcType === 'premium' ? 'selected' : ''}`}\n              onClick={() => {\n                setCalcType('premium');\n                setAmountRaw('');\n                setAmountDisplay('');\n                setAmountError('');\n              }}\n            >\n              <div>Страхового</div>\n              <div>взноса</div>\n            </button>\n            <button\n              className={`insurance-btn ${calcType === 'sum' ? 'selected' : ''}`}\n              onClick={() => {\n                setCalcType('sum');\n                setAmountRaw('');\n                setAmountDisplay('');\n                setAmountError('');\n              }}\n            >\n              <div>Страховой</div>\n              <div>суммы</div>\n            </button>\n          </div>\n\n          {/* Поле ввода суммы (активно, если calcType != null) */}\n          {calcType && (\n            <>\n              <div className=\"section-subtitle\">Введите сумму в рублях:</div>\n              <div className=\"sum-section\">\n                <input\n                  type=\"text\"\n                  placeholder=\"Мин. 100 000\"\n                  value={amountDisplay}\n                  onChange={handleAmountChange}\n                />\n              </div>\n              {amountError && <div className=\"input-error\">{amountError}</div>}\n            </>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  // --- Экран «Связаться с менеджером» (stage='manager') ---\n  if (stage === 'manager') {\n    return (\n      <div\n        className=\"snp-container\"\n        style={{ backgroundImage: `url(${backgroundImage})` }}\n      >\n        <div className=\"polls-header\">\n          {/* Кнопка «Назад» (возвращает на результат) */}\n          <button className=\"back-btn\" onClick={() => setStage('result')}>\n            <svg viewBox=\"0 0 24 24\">\n              <path d=\"M3 11l9-8 9 8v10a1 1 0 0 1-1 1h-5v-7h-6v7H4a1 1 0 0 1-1-1V11z\" />\n            </svg>\n          </button>\n          {/* Логотип */}\n          <div className=\"logo-wrapper animate-logo\">\n            <img className=\"poll-logo\" src={logoImage} alt=\"Логотип\" />\n          </div>\n        </div>\n\n        <div className=\"content-wrapper\">\n          <h2 className=\"contact-title\">Введите Ваши данные:</h2>\n\n          <div className=\"contact-form\">\n            <label>Фамилия:</label>\n            <input\n              type=\"text\"\n              placeholder=\"Введите фамилию\"\n              value={mgrSurname}\n              onChange={e => setMgrSurname(e.target.value)}\n            />\n\n            <label>Имя:</label>\n            <input\n              type=\"text\"\n              placeholder=\"Введите имя\"\n              value={mgrName}\n              onChange={e => setMgrName(e.target.value)}\n            />\n\n            <label>Город работы:</label>\n            <input\n              type=\"text\"\n              placeholder=\"Введите город\"\n              value={mgrCity}\n              onChange={e => setMgrCity(e.target.value)}\n            />\n          </div>\n          {mgrError && <div className=\"input-error\">{mgrError}</div>}\n\n          <button\n            className=\"contact-btn\"\n            onClick={handleManagerSubmit}\n            disabled={isSendingMgr}\n          >\n            Отправить запрос\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // Если ни одна стадия не подошла — null\n  return null;\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}