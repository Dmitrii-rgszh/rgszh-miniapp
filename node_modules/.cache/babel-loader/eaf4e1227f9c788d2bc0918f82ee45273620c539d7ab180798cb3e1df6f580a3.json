{"ast":null,"code":"// src/SNPPage.js\nimport React,{useState}from'react';import{useNavigate}from'react-router-dom';import logoImage from'./components/logo.png';import backgroundImage from'./components/background.png';import DateWheelPicker from'./DateWheelPicker';import'./PollsPage.css';import'./SNPPage.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function SNPPage(){const navigate=useNavigate();// ===== Состояния =====\nconst[step,setStep]=useState(1);const[email,setEmail]=useState('');const[emailError,setEmailError]=useState('');const[birthDate,setBirthDate]=useState(new Date());const[gender,setGender]=useState(null);// 'мужской' | 'женский' | null\nconst[calcType,setCalcType]=useState(null);// 'premium' | 'sum' | null\nconst[amountRaw,setAmountRaw]=useState('');// чистые цифры (например \"60000\")\nconst[amountDisplay,setAmountDisplay]=useState('');// с точками (например \"60.000\")\nconst[amountError,setAmountError]=useState('');const[isProcessing,setIsProcessing]=useState(false);const[resultData,setResultData]=useState(null);const[carouselIndex,setCarouselIndex]=useState(0);// текущая страница карусели (0,1,2)\n// Email валидность: ок, если заканчивается на \"@vtb.ru\"\nconst emailValid=email.toLowerCase().endsWith('@vtb.ru');// ===== Вспомогательные функции =====\nfunction getAge(d){if(!(d instanceof Date))return 0;const today=new Date();let age=today.getFullYear()-d.getFullYear();if(today.getMonth()<d.getMonth()||today.getMonth()===d.getMonth()&&today.getDate()<d.getDate()){age--;}return age;}function isAmountValid(){const n=parseInt(amountRaw,10)||0;return calcType==='premium'&&n>=60000||calcType==='sum'&&n>=450000;}function canGoNext(){return step===2&&getAge(birthDate)>=18&&gender&&calcType&&amountRaw&&isAmountValid();}// ===== Обработчик: Шаг 1 → Шаг 2 =====\nfunction handleEmailNext(){if(!emailValid){setEmailError('Используйте корпоративную почту домена @vtb.ru');return;}setEmailError('');// Сброс скрытых полей перед вторым шагом\nsetGender(null);setCalcType(null);setAmountRaw('');setAmountDisplay('');setAmountError('');setStep(2);}// ===== Обработчик изменения суммы: форматируем с точками =====\nfunction onAmountChange(e){const raw=e.target.value.replace(/\\D/g,'');// оставляем только цифры\nsetAmountRaw(raw);// Форматируем display с разделением тысяч через точку\nlet d=raw,o='';while(d.length>3){o='.'+d.slice(-3)+o;d=d.slice(0,-3);}setAmountDisplay(d+o);const n=parseInt(raw,10)||0;if(calcType==='premium'&&n<60000){setAmountError('Мин. 60 000 ₽');}else if(calcType==='sum'&&n<450000){setAmountError('Мин. 450 000 ₽');}else{setAmountError('');}}// ===== Обработчик: Шаг 2 → Отправка на сервер =====\nasync function handleNext(){if(!canGoNext())return;setIsProcessing(true);const dateStr=birthDate.toLocaleDateString('ru-RU',{day:'2-digit',month:'2-digit',year:'numeric'});const payload={email,birthdate:dateStr,age:getAge(birthDate),gender,payment:calcType==='premium'?'Страхового взноса':'Страховой суммы',sum:parseInt(amountRaw,10)};try{const res=await fetch('/api/proxy/snp/save',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});if(!res.ok){console.error('Ошибка сервера',res.status,await res.text());alert(`Ошибка ${res.status}: смотрите консоль`);}else{const data=await res.json();// Сервер возвращает объект вида:\n// {\n//   calculationDate: \"...\",\n//   gender: \"...\",\n//   age: ...,\n//   payment: \"...\",\n//   basePremium: ...,\n//   totalPremium: ...,\n//   termYears: ...,\n//   frequency: ...,\n//   contribution: rv(\"C13\"),            // C13\n//   totalContribution: rv(\"C16\"),       // C16\n//   accrualPercent: rv(\"H12\"),          // H12 (например 0.44)\n//   accrualAmount: rv(\"H13\"),           // H13\n//   totalAccrual: rv(\"H16\"),            // H16\n//   finalAnnual: rv(\"M13\"),             // M13\n//   finalTotal: rv(\"M16\"),              // M16\n//   …\n// }\nsetResultData(data);setCarouselIndex(0);// начинаем карусель с первой страницы\n}}catch(err){console.error('Ошибка запроса:',err);alert('Не удалось выполнить запрос');}finally{setIsProcessing(false);}}function goHome(){navigate(-1);}// ===== Экран «Выполняется расчёт…» =====\nif(isProcessing){return/*#__PURE__*/_jsxs(\"div\",{className:\"processing-screen\",style:{backgroundImage:`url(${backgroundImage})`},children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo-wrapper animate-logo\",children:/*#__PURE__*/_jsx(\"img\",{className:\"poll-logo\",src:logoImage,alt:\"\\u041B\\u043E\\u0433\\u043E\\u0442\\u0438\\u043F\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"processing-title\",children:\"\\u0412\\u044B\\u043F\\u043E\\u043B\\u043D\\u044F\\u0435\\u0442\\u0441\\u044F \\u0440\\u0430\\u0441\\u0447\\u0451\\u0442 \\u043F\\u043E \\u043F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0435 \\xAB\\u0421\\u0442\\u0440\\u0430\\u0442\\u0435\\u0433\\u0438\\u044F \\u043D\\u0430 \\u043F\\u044F\\u0442\\u044C. \\u0413\\u0430\\u0440\\u0430\\u043D\\u0442\\xBB\"}),/*#__PURE__*/_jsx(\"div\",{className:\"arrow-animation\",children:\"\\u2192\"})]});}// ===== Если resultData есть — показываем карточку с результатами + карусель =====\nif(resultData){// Сегодняшняя дата для «Дата расчёта»\nconst todayStr=new Date().toLocaleDateString('ru-RU',{day:'2-digit',month:'2-digit',year:'numeric'});const{gender:resGender,payment:resPayment,contribution,// C13 (число или строка)\ntotalContribution,// C16 (число или строка)\naccrualPercent,// H12 (0.44)\naccrualAmount,// H13\ntotalAccrual,// H16\nfinalAnnual,// M13\nfinalTotal// M16\n}=resultData;// Преобразуем accrualPercent из 0.44 → 44 (%)\nconst accrualPercentDisplay=Math.round(Number(accrualPercent)*100);// Функция-форматтер: «100000» → «100 000»\nfunction fmt(number){return Number(number).toLocaleString('ru-RU',{minimumFractionDigits:0});}return/*#__PURE__*/_jsxs(\"div\",{className:\"snp-container\",style:{backgroundImage:`url(${backgroundImage})`},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"polls-header\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-btn\",onClick:goHome,children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M3 11l9-8 9 8v10a1 1 0 0 1-1 1h-5v-7h-6v7H4a1 1 0 0 1-1-1V11z\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"logo-wrapper animate-logo\",children:/*#__PURE__*/_jsx(\"img\",{className:\"poll-logo\",src:logoImage,alt:\"\\u041B\\u043E\\u0433\\u043E\\u0442\\u0438\\u043F\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"repeat-btn\",onClick:()=>{// При повторном расчёте очищаем все поля и возвращаемся на шаг 2\nsetResultData(null);setGender(null);setCalcType(null);setAmountRaw('');setAmountDisplay('');setAmountError('');setStep(2);},children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M12 4V1L8 5l4 4V6 c4.41 0 8 3.59 8 8 s-3.59 8-8 8-8-3.59-8-8h2 c0 3.31 2.69 6 6 6s6-2.69 6-6 -2.69-6-6-6v3l-4-4 4-4z\",fill:\"#fff\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"content-wrapper\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"polls-title\",children:\"\\u0420\\u0430\\u0441\\u0447\\u0451\\u0442 \\u043F\\u043E \\u043F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0435 \\xAB\\u0421\\u0442\\u0440\\u0430\\u0442\\u0435\\u0433\\u0438\\u044F \\u043D\\u0430 \\u043F\\u044F\\u0442\\u044C. \\u0413\\u0430\\u0440\\u0430\\u043D\\u0442\\xBB\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"params-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\u041F\\u0430\\u0440\\u0430\\u043C\\u0435\\u0442\\u0440\\u044B\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0414\\u0430\\u0442\\u0430 \\u0440\\u0430\\u0441\\u0447\\u0451\\u0442\\u0430: \",todayStr]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0412\\u043E\\u0437\\u0440\\u0430\\u0441\\u0442: \",getAge(birthDate),\" \\u043B\\u0435\\u0442\"]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u041F\\u043E\\u043B: \",resGender]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0420\\u0430\\u0441\\u0447\\u0451\\u0442 \\u043E\\u0442: \",resPayment]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"carousel-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"carousel-indicators\",children:[/*#__PURE__*/_jsx(\"span\",{className:carouselIndex===0?'active':''}),/*#__PURE__*/_jsx(\"span\",{className:carouselIndex===1?'active':''}),/*#__PURE__*/_jsx(\"span\",{className:carouselIndex===2?'active':''})]}),/*#__PURE__*/_jsx(\"div\",{className:\"carousel-clipper\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"carousel-wrapper\",style:{transform:`translateX(-${carouselIndex*100}%)`},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"carousel-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"first-line\",children:\"\\u0412 \\u0442\\u0435\\u0447\\u0435\\u043D\\u0438\\u0435 5 \\u043B\\u0435\\u0442\"}),/*#__PURE__*/_jsx(\"div\",{className:\"unit\",children:\"\\u0412\\u044B \\u0432\\u043D\\u043E\\u0441\\u0438\\u0442\\u0435 \\u0441\\u0440\\u0435\\u0434\\u0441\\u0442\\u0432\\u0430 \\u0432 \\u043F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0443\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[fmt(contribution),\" \\u20BD\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"unit\",children:\"\\u0415\\u0436\\u0435\\u0433\\u043E\\u0434\\u043D\\u043E\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[fmt(totalContribution),\" \\u20BD\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"footer-label\",children:\"\\u0421\\u0443\\u043C\\u043C\\u0430 \\u0432\\u0430\\u0448\\u0438\\u0445 \\u0432\\u0437\\u043D\\u043E\\u0441\\u043E\\u0432\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"carousel-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"first-line\",children:\"\\u041D\\u0430\\u0447\\u0438\\u0441\\u043B\\u044F\\u0435\\u043C \\u0434\\u043E\\u043F\\u043E\\u043B\\u043D\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"unit\",children:[accrualPercentDisplay,\"% \\u043E\\u0442 \\u043A\\u0430\\u0436\\u0434\\u043E\\u0433\\u043E \\u0432\\u0437\\u043D\\u043E\\u0441\\u0430\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[fmt(accrualAmount),\" \\u20BD\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"unit\",children:\"\\u0415\\u0436\\u0435\\u0433\\u043E\\u0434\\u043D\\u043E\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[fmt(totalAccrual),\" \\u20BD\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"footer-label\",children:\"\\u041E\\u0431\\u0449\\u0430\\u044F \\u0441\\u0443\\u043C\\u043C\\u0430 \\u043D\\u0430\\u0447\\u0438\\u0441\\u043B\\u0435\\u043D\\u0438\\u0439\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"carousel-page\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"first-line\",children:\"\\u0418\\u0442\\u043E\\u0433\\u043E\\u0432\\u0430\\u044F \\u0433\\u043E\\u0434\\u043E\\u0432\\u0430\\u044F \\u0432\\u044B\\u043F\\u043B\\u0430\\u0442\\u0430\"}),/*#__PURE__*/_jsx(\"div\",{className:\"unit\",children:\"\\u0421\\u0443\\u043C\\u043C\\u0430 \\u0441 \\u043D\\u0430\\u0447\\u0438\\u0441\\u043B\\u0435\\u043D\\u0438\\u044F\\u043C\\u0438\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[fmt(finalAnnual),\" \\u20BD\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"unit\",children:\"\\u0421\\u0443\\u043C\\u043C\\u0430 \\u0437\\u0430 5 \\u043B\\u0435\\u0442\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"value\",children:[fmt(finalTotal),\" \\u20BD\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"footer-label\",children:\"\\u0412\\u0430\\u0448 \\u043A\\u0430\\u043F\\u0438\\u0442\\u0430\\u043B \\u0447\\u0435\\u0440\\u0435\\u0437 5 \\u043B\\u0435\\u0442\"})]})]})}),/*#__PURE__*/_jsx(\"button\",{className:\"carousel-control prev\",onClick:()=>setCarouselIndex(idx=>idx-1),disabled:carouselIndex===0,children:\"\\u2039\"}),/*#__PURE__*/_jsx(\"button\",{className:\"carousel-control next\",onClick:()=>setCarouselIndex(idx=>idx+1),disabled:carouselIndex===2,children:\"\\u203A\"})]}),/*#__PURE__*/_jsx(\"button\",{className:\"contact-btn\",children:\"\\u0421\\u0432\\u044F\\u0437\\u0430\\u0442\\u044C\\u0441\\u044F \\u0441 \\u043C\\u0435\\u043D\\u0435\\u0434\\u0436\\u0435\\u0440\\u043E\\u043C\"})]})]});}// ===== ОСНОВНОЙ UI (Шаг 1 и Шаг 2) =====\nreturn/*#__PURE__*/_jsxs(\"div\",{className:\"snp-container\",style:{backgroundImage:`url(${backgroundImage})`},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"polls-header\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-btn\",onClick:goHome,children:/*#__PURE__*/_jsx(\"svg\",{viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M3 11l9-8 9 8v10a1 1 0 0 1-1 1h-5v-7h-6v7H4a1 1 0 0 1-1-1V11z\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"logo-wrapper animate-logo\",children:/*#__PURE__*/_jsx(\"img\",{className:\"poll-logo\",src:logoImage,alt:\"\\u041B\\u043E\\u0433\\u043E\\u0442\\u0438\\u043F\"})}),/*#__PURE__*/_jsx(\"button\",{className:\"forward-btn\",onClick:step===1?handleEmailNext:handleNext,disabled:step===1?!emailValid:!canGoNext(),children:/*#__PURE__*/_jsx(\"span\",{className:\"arrow-icon\",children:\"\\u2192\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"content-wrapper\",children:[step===1&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"email-step\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"email-label\",children:\"\\u041A\\u043E\\u0440\\u043F\\u043E\\u0440\\u0430\\u0442\\u0438\\u0432\\u043D\\u0430\\u044F \\u043F\\u043E\\u0447\\u0442\\u0430 \\u0412\\u0422\\u0411:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",placeholder:\"example@vtb.ru\",value:email,onChange:e=>setEmail(e.target.value)})]}),emailError&&/*#__PURE__*/_jsx(\"div\",{className:\"input-error\",children:emailError}),/*#__PURE__*/_jsx(\"button\",{className:\"polls-btn btn1\",onClick:handleEmailNext,disabled:!emailValid,children:\"\\u041F\\u0440\\u043E\\u0434\\u043E\\u043B\\u0436\\u0438\\u0442\\u044C\"})]}),step===2&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"polls-title\",children:\"\\u0420\\u0430\\u0441\\u0447\\u0451\\u0442 \\u043F\\u043E \\u043F\\u0440\\u043E\\u0433\\u0440\\u0430\\u043C\\u043C\\u0435 \\xAB\\u0421\\u0442\\u0440\\u0430\\u0442\\u0435\\u0433\\u0438\\u044F \\u043D\\u0430 \\u043F\\u044F\\u0442\\u044C. \\u0413\\u0430\\u0440\\u0430\\u043D\\u0442\\xBB\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"date-section\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"section-label\",children:\"\\u0414\\u0430\\u0442\\u0430 \\u0440\\u043E\\u0436\\u0434\\u0435\\u043D\\u0438\\u044F:\"}),/*#__PURE__*/_jsx(DateWheelPicker,{value:birthDate,onChange:val=>{if(val instanceof Date){setBirthDate(val);}else if(val!==null&&val!==void 0&&val.day){setBirthDate(new Date(val.year,val.month-1,val.day));}}})]}),/*#__PURE__*/_jsx(\"div\",{className:\"section-subtitle\",children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043F\\u043E\\u043B:\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"gender-section\",children:[/*#__PURE__*/_jsxs(\"button\",{className:`insurance-btn ${gender==='мужской'?'selected':''}`,onClick:()=>setGender('мужской'),children:[/*#__PURE__*/_jsx(\"div\",{children:\"\\u041C\\u0443\\u0436\\u0441\\u043A\\u043E\\u0439\"}),/*#__PURE__*/_jsx(\"div\",{className:\"emoji\",children:\"\\uD83D\\uDC68\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:`insurance-btn ${gender==='женский'?'selected':''}`,onClick:()=>setGender('женский'),children:[/*#__PURE__*/_jsx(\"div\",{children:\"\\u0416\\u0435\\u043D\\u0441\\u043A\\u0438\\u0439\"}),/*#__PURE__*/_jsx(\"div\",{className:\"emoji\",children:\"\\uD83D\\uDC69\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"section-subtitle\",children:\"\\u0420\\u0430\\u0441\\u0447\\u0451\\u0442 \\u043E\\u0442\\u2026\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"insurance-options\",children:[/*#__PURE__*/_jsxs(\"button\",{className:`insurance-btn ${calcType==='premium'?'selected':''}`,onClick:()=>setCalcType('premium'),children:[/*#__PURE__*/_jsx(\"div\",{children:\"\\u0421\\u0442\\u0440\\u0430\\u0445\\u043E\\u0432\\u043E\\u0433\\u043E\"}),/*#__PURE__*/_jsx(\"div\",{children:\"\\u0432\\u0437\\u043D\\u043E\\u0441\\u0430\"})]}),/*#__PURE__*/_jsxs(\"button\",{className:`insurance-btn ${calcType==='sum'?'selected':''}`,onClick:()=>setCalcType('sum'),children:[/*#__PURE__*/_jsx(\"div\",{children:\"\\u0421\\u0442\\u0440\\u0430\\u0445\\u043E\\u0432\\u043E\\u0439\"}),/*#__PURE__*/_jsx(\"div\",{children:\"\\u0441\\u0443\\u043C\\u043C\\u044B\"})]})]}),calcType&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"section-subtitle\",children:\"\\u0421\\u0443\\u043C\\u043C\\u0430 (\\u20BD):\"}),/*#__PURE__*/_jsx(\"div\",{className:\"sum-section\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:calcType==='premium'?'Мин. 60 000':'Мин. 450 000',value:amountDisplay,onChange:onAmountChange})}),amountError&&/*#__PURE__*/_jsx(\"div\",{className:\"input-error\",children:amountError})]})]})]})]});}","map":{"version":3,"names":["React","useState","useNavigate","logoImage","backgroundImage","DateWheelPicker","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","SNPPage","navigate","step","setStep","email","setEmail","emailError","setEmailError","birthDate","setBirthDate","Date","gender","setGender","calcType","setCalcType","amountRaw","setAmountRaw","amountDisplay","setAmountDisplay","amountError","setAmountError","isProcessing","setIsProcessing","resultData","setResultData","carouselIndex","setCarouselIndex","emailValid","toLowerCase","endsWith","getAge","d","today","age","getFullYear","getMonth","getDate","isAmountValid","n","parseInt","canGoNext","handleEmailNext","onAmountChange","e","raw","target","value","replace","o","length","slice","handleNext","dateStr","toLocaleDateString","day","month","year","payload","birthdate","payment","sum","res","fetch","method","headers","body","JSON","stringify","ok","console","error","status","text","alert","data","json","err","goHome","className","style","children","src","alt","todayStr","resGender","resPayment","contribution","totalContribution","accrualPercent","accrualAmount","totalAccrual","finalAnnual","finalTotal","accrualPercentDisplay","Math","round","Number","fmt","number","toLocaleString","minimumFractionDigits","onClick","viewBox","fill","transform","idx","disabled","type","placeholder","onChange","val"],"sources":["C:/Users/shapeless/Desktop/miniapp/src/SNPPage.js"],"sourcesContent":["// src/SNPPage.js\n\nimport React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\n\nimport logoImage       from './components/logo.png';\nimport backgroundImage from './components/background.png';\nimport DateWheelPicker from './DateWheelPicker';\n\nimport './PollsPage.css';\nimport './SNPPage.css';\n\nexport default function SNPPage() {\n  const navigate = useNavigate();\n\n  // ===== Состояния =====\n  const [step, setStep]                   = useState(1);\n  const [email, setEmail]                 = useState('');\n  const [emailError, setEmailError]       = useState('');\n  const [birthDate, setBirthDate]         = useState(new Date());\n  const [gender, setGender]               = useState(null);    // 'мужской' | 'женский' | null\n  const [calcType, setCalcType]           = useState(null);    // 'premium' | 'sum' | null\n  const [amountRaw, setAmountRaw]         = useState('');      // чистые цифры (например \"60000\")\n  const [amountDisplay, setAmountDisplay] = useState('');      // с точками (например \"60.000\")\n  const [amountError, setAmountError]     = useState('');\n  const [isProcessing, setIsProcessing]   = useState(false);\n  const [resultData, setResultData]       = useState(null);\n  const [carouselIndex, setCarouselIndex] = useState(0);       // текущая страница карусели (0,1,2)\n\n  // Email валидность: ок, если заканчивается на \"@vtb.ru\"\n  const emailValid = email.toLowerCase().endsWith('@vtb.ru');\n\n  // ===== Вспомогательные функции =====\n  function getAge(d) {\n    if (!(d instanceof Date)) return 0;\n    const today = new Date();\n    let age = today.getFullYear() - d.getFullYear();\n    if (\n      today.getMonth() < d.getMonth() ||\n      (today.getMonth() === d.getMonth() && today.getDate() < d.getDate())\n    ) {\n      age--;\n    }\n    return age;\n  }\n\n  function isAmountValid() {\n    const n = parseInt(amountRaw, 10) || 0;\n    return (calcType === 'premium' && n >= 60000) ||\n           (calcType === 'sum'     && n >= 450000);\n  }\n\n  function canGoNext() {\n    return (\n      step === 2 &&\n      getAge(birthDate) >= 18 &&\n      gender &&\n      calcType &&\n      amountRaw &&\n      isAmountValid()\n    );\n  }\n\n  // ===== Обработчик: Шаг 1 → Шаг 2 =====\n  function handleEmailNext() {\n    if (!emailValid) {\n      setEmailError('Используйте корпоративную почту домена @vtb.ru');\n      return;\n    }\n    setEmailError('');\n    // Сброс скрытых полей перед вторым шагом\n    setGender(null);\n    setCalcType(null);\n    setAmountRaw('');\n    setAmountDisplay('');\n    setAmountError('');\n    setStep(2);\n  }\n\n  // ===== Обработчик изменения суммы: форматируем с точками =====\n  function onAmountChange(e) {\n    const raw = e.target.value.replace(/\\D/g, ''); // оставляем только цифры\n    setAmountRaw(raw);\n\n    // Форматируем display с разделением тысяч через точку\n    let d = raw, o = '';\n    while (d.length > 3) {\n      o = '.' + d.slice(-3) + o;\n      d = d.slice(0, -3);\n    }\n    setAmountDisplay(d + o);\n\n    const n = parseInt(raw, 10) || 0;\n    if (calcType === 'premium' && n < 60000) {\n      setAmountError('Мин. 60 000 ₽');\n    } else if (calcType === 'sum' && n < 450000) {\n      setAmountError('Мин. 450 000 ₽');\n    } else {\n      setAmountError('');\n    }\n  }\n\n  // ===== Обработчик: Шаг 2 → Отправка на сервер =====\n  async function handleNext() {\n    if (!canGoNext()) return;\n    setIsProcessing(true);\n\n    const dateStr = birthDate.toLocaleDateString('ru-RU', {\n      day: '2-digit', month: '2-digit', year: 'numeric'\n    });\n    const payload = {\n      email,\n      birthdate: dateStr,\n      age:        getAge(birthDate),\n      gender,\n      payment:    calcType === 'premium' ? 'Страхового взноса' : 'Страховой суммы',\n      sum:        parseInt(amountRaw, 10)\n    };\n\n    try {\n      const res = await fetch('/api/proxy/snp/save', {\n        method:  'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body:    JSON.stringify(payload)\n      });\n      if (!res.ok) {\n        console.error('Ошибка сервера', res.status, await res.text());\n        alert(`Ошибка ${res.status}: смотрите консоль`);\n      } else {\n        const data = await res.json();\n        // Сервер возвращает объект вида:\n        // {\n        //   calculationDate: \"...\",\n        //   gender: \"...\",\n        //   age: ...,\n        //   payment: \"...\",\n        //   basePremium: ...,\n        //   totalPremium: ...,\n        //   termYears: ...,\n        //   frequency: ...,\n        //   contribution: rv(\"C13\"),            // C13\n        //   totalContribution: rv(\"C16\"),       // C16\n        //   accrualPercent: rv(\"H12\"),          // H12 (например 0.44)\n        //   accrualAmount: rv(\"H13\"),           // H13\n        //   totalAccrual: rv(\"H16\"),            // H16\n        //   finalAnnual: rv(\"M13\"),             // M13\n        //   finalTotal: rv(\"M16\"),              // M16\n        //   …\n        // }\n        setResultData(data);\n        setCarouselIndex(0); // начинаем карусель с первой страницы\n      }\n    } catch (err) {\n      console.error('Ошибка запроса:', err);\n      alert('Не удалось выполнить запрос');\n    } finally {\n      setIsProcessing(false);\n    }\n  }\n\n  function goHome() {\n    navigate(-1);\n  }\n\n\n  // ===== Экран «Выполняется расчёт…» =====\n  if (isProcessing) {\n    return (\n      <div className=\"processing-screen\" style={{ backgroundImage: `url(${backgroundImage})` }}>\n        <div className=\"logo-wrapper animate-logo\">\n          <img className=\"poll-logo\" src={logoImage} alt=\"Логотип\" />\n        </div>\n        <p className=\"processing-title\">\n          Выполняется расчёт по программе «Стратегия на пять. Гарант»\n        </p>\n        <div className=\"arrow-animation\">→</div>\n      </div>\n    );\n  }\n\n\n  // ===== Если resultData есть — показываем карточку с результатами + карусель =====\n  if (resultData) {\n    // Сегодняшняя дата для «Дата расчёта»\n    const todayStr = new Date().toLocaleDateString('ru-RU', {\n      day: '2-digit', month: '2-digit', year: 'numeric'\n    });\n\n    const {\n      gender:            resGender,\n      payment:           resPayment,\n      contribution,      // C13 (число или строка)\n      totalContribution, // C16 (число или строка)\n      accrualPercent,    // H12 (0.44)\n      accrualAmount,     // H13\n      totalAccrual,      // H16\n      finalAnnual,       // M13\n      finalTotal         // M16\n    } = resultData;\n\n    // Преобразуем accrualPercent из 0.44 → 44 (%)\n    const accrualPercentDisplay = Math.round(Number(accrualPercent) * 100);\n\n    // Функция-форматтер: «100000» → «100 000»\n    function fmt(number) {\n      return Number(number).toLocaleString('ru-RU', { minimumFractionDigits: 0 });\n    }\n\n    return (\n      <div className=\"snp-container\" style={{ backgroundImage: `url(${backgroundImage})` }}>\n        <div className=\"polls-header\">\n          <button className=\"back-btn\" onClick={goHome}>\n            <svg viewBox=\"0 0 24 24\">\n              <path d=\"M3 11l9-8 9 8v10a1 1 0 0 1-1 1h-5v-7h-6v7H4a1 1 0 0 1-1-1V11z\" />\n            </svg>\n          </button>\n          <div className=\"logo-wrapper animate-logo\">\n            <img className=\"poll-logo\" src={logoImage} alt=\"Логотип\" />\n          </div>\n          <button\n            className=\"repeat-btn\"\n            onClick={() => {\n              // При повторном расчёте очищаем все поля и возвращаемся на шаг 2\n              setResultData(null);\n              setGender(null);\n              setCalcType(null);\n              setAmountRaw('');\n              setAmountDisplay('');\n              setAmountError('');\n              setStep(2);\n            }}\n          >\n            <svg viewBox=\"0 0 24 24\">\n              <path\n                d=\"M12 4V1L8 5l4 4V6\n                   c4.41 0 8 3.59 8 8\n                   s-3.59 8-8 8-8-3.59-8-8h2\n                   c0 3.31 2.69 6 6 6s6-2.69 6-6\n                   -2.69-6-6-6v3l-4-4 4-4z\"\n                fill=\"#fff\"\n              />\n            </svg>\n          </button>\n        </div>\n\n        <div className=\"content-wrapper\">\n          <h1 className=\"polls-title\">\n            Расчёт по программе «Стратегия на пять. Гарант»\n          </h1>\n\n          <div className=\"params-container\">\n            <h2>Параметры</h2>\n            <p>Дата расчёта: {todayStr}</p>\n            <p>Возраст: {getAge(birthDate)} лет</p>\n            <p>Пол: {resGender}</p>\n            <p>Расчёт от: {resPayment}</p>\n          </div>\n\n          {/* ==== КАРУСЕЛЬ ==== */}\n          <div className=\"carousel-container\">\n            {/* Индикаторы (три полоски сверху) */}\n            <div className=\"carousel-indicators\">\n              <span className={carouselIndex === 0 ? 'active' : ''}></span>\n              <span className={carouselIndex === 1 ? 'active' : ''}></span>\n              <span className={carouselIndex === 2 ? 'active' : ''}></span>\n            </div>\n\n            {/* «Окно» с overflow:hidden */}\n            <div className=\"carousel-clipper\">\n              <div\n                className=\"carousel-wrapper\"\n                style={{ transform: `translateX(-${carouselIndex * 100}%)` }}\n              >\n                {/* ===== Страница 1 ===== */}\n                <div className=\"carousel-page\">\n                  <div className=\"first-line\">В течение 5 лет</div>\n                  <div className=\"unit\">Вы вносите средства в программу</div>\n                  <div className=\"value\">{fmt(contribution)} ₽</div>\n                  <div className=\"unit\">Ежегодно</div>\n                  <div className=\"value\">{fmt(totalContribution)} ₽</div>\n                  <div className=\"footer-label\">Сумма ваших взносов</div>\n                </div>\n\n                {/* ===== Страница 2 ===== */}\n                <div className=\"carousel-page\">\n                  <div className=\"first-line\">Начисляем дополнительно</div>\n                  <div className=\"unit\">{accrualPercentDisplay}% от каждого взноса</div>\n                  <div className=\"value\">{fmt(accrualAmount)} ₽</div>\n                  <div className=\"unit\">Ежегодно</div>\n                  <div className=\"value\">{fmt(totalAccrual)} ₽</div>\n                  <div className=\"footer-label\">Общая сумма начислений</div>\n                </div>\n\n                {/* ===== Страница 3 ===== */}\n                <div className=\"carousel-page\">\n                  <div className=\"first-line\">Итоговая годовая выплата</div>\n                  <div className=\"unit\">Сумма с начислениями</div>\n                  <div className=\"value\">{fmt(finalAnnual)} ₽</div>\n                  <div className=\"unit\">Сумма за 5 лет</div>\n                  <div className=\"value\">{fmt(finalTotal)} ₽</div>\n                  <div className=\"footer-label\">Ваш капитал через 5 лет</div>\n                </div>\n              </div>\n            </div>\n\n            {/* Кнопки навигации карусели */}\n            <button\n              className=\"carousel-control prev\"\n              onClick={() => setCarouselIndex(idx => idx - 1)}\n              disabled={carouselIndex === 0}\n            >\n              ‹\n            </button>\n            <button\n              className=\"carousel-control next\"\n              onClick={() => setCarouselIndex(idx => idx + 1)}\n              disabled={carouselIndex === 2}\n            >\n              ›\n            </button>\n          </div>\n          {/* ==== конец КАРУСЕЛИ ==== */}\n\n          {/* Кнопка «Связаться с менеджером» — всегда видна на шаге результатов */}\n          <button className=\"contact-btn\">Связаться с менеджером</button>\n        </div>\n      </div>\n    );\n  }\n\n\n  // ===== ОСНОВНОЙ UI (Шаг 1 и Шаг 2) =====\n  return (\n    <div className=\"snp-container\" style={{ backgroundImage:`url(${backgroundImage})` }}>\n      <div className=\"polls-header\">\n        <button className=\"back-btn\" onClick={goHome}>\n          <svg viewBox=\"0 0 24 24\">\n            <path d=\"M3 11l9-8 9 8v10a1 1 0 0 1-1 1h-5v-7h-6v7H4a1 1 0 0 1-1-1V11z\" />\n          </svg>\n        </button>\n        <div className=\"logo-wrapper animate-logo\">\n          <img className=\"poll-logo\" src={logoImage} alt=\"Логотип\" />\n        </div>\n        <button\n          className=\"forward-btn\"\n          onClick={step === 1 ? handleEmailNext : handleNext}\n          disabled={step === 1 ? !emailValid : !canGoNext()}\n        >\n          <span className=\"arrow-icon\">→</span>\n        </button>\n      </div>\n\n      <div className=\"content-wrapper\">\n        {/* ===== Шаг 1: Ввод корпоративной почты ===== */}\n        {step === 1 && (\n          <>\n            <div className=\"email-step\">\n              <label className=\"email-label\">Корпоративная почта ВТБ:</label>\n              <input\n                type=\"email\"\n                placeholder=\"example@vtb.ru\"\n                value={email}\n                onChange={e => setEmail(e.target.value)}\n              />\n            </div>\n            {emailError && <div className=\"input-error\">{emailError}</div>}\n\n            <button\n              className=\"polls-btn btn1\"\n              onClick={handleEmailNext}\n              disabled={!emailValid}\n            >\n              Продолжить\n            </button>\n          </>\n        )}\n\n        {/* ===== Шаг 2: Ввод данных пользователя ===== */}\n        {step === 2 && (\n          <>\n            <h1 className=\"polls-title\">\n              Расчёт по программе «Стратегия на пять. Гарант»\n            </h1>\n\n            <div className=\"date-section\">\n              <label className=\"section-label\">Дата рождения:</label>\n              <DateWheelPicker\n                value={birthDate}\n                onChange={val => {\n                  if (val instanceof Date) {\n                    setBirthDate(val);\n                  } else if (val?.day) {\n                    setBirthDate(new Date(val.year, val.month - 1, val.day));\n                  }\n                }}\n              />\n            </div>\n\n            <div className=\"section-subtitle\">Выберите пол:</div>\n            <div className=\"gender-section\">\n              <button\n                className={`insurance-btn ${gender === 'мужской' ? 'selected' : ''}`}\n                onClick={() => setGender('мужской')}\n              >\n                <div>Мужской</div>\n                <div className=\"emoji\">👨</div>\n              </button>\n              <button\n                className={`insurance-btn ${gender === 'женский' ? 'selected' : ''}`}\n                onClick={() => setGender('женский')}\n              >\n                <div>Женский</div>\n                <div className=\"emoji\">👩</div>\n              </button>\n            </div>\n\n            <div className=\"section-subtitle\">Расчёт от…</div>\n            <div className=\"insurance-options\">\n              <button\n                className={`insurance-btn ${calcType === 'premium' ? 'selected' : ''}`}\n                onClick={() => setCalcType('premium')}\n              >\n                <div>Страхового</div>\n                <div>взноса</div>\n              </button>\n              <button\n                className={`insurance-btn ${calcType === 'sum' ? 'selected' : ''}`}\n                onClick={() => setCalcType('sum')}\n              >\n                <div>Страховой</div>\n                <div>суммы</div>\n              </button>\n            </div>\n\n            {calcType && (\n              <>\n                <div className=\"section-subtitle\">Сумма (₽):</div>\n                <div className=\"sum-section\">\n                  <input\n                    type=\"text\"\n                    placeholder={calcType === 'premium' ? 'Мин. 60 000' : 'Мин. 450 000'}\n                    value={amountDisplay}\n                    onChange={onAmountChange}\n                  />\n                </div>\n                {amountError && <div className=\"input-error\">{amountError}</div>}\n              </>\n            )}\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}