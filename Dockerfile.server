FROM python:3.11-alpine
WORKDIR /app
COPY requirements.txt ./
RUN apk add --no-cache \
      gcc musl-dev postgresql-dev libffi-dev openssl-dev \
    && pip install --no-cache-dir -r requirements.txt \
    && pip install --no-cache-dir python-dotenv
COPY . .
EXPOSE 5000
CMD ["gunicorn", \
     "--bind", "0.0.0.0:5000", \
     "server:app", \
     "--worker-class", "geventwebsocket.gunicorn.workers.GeventWebSocketWorker", \
     "--workers", "2"]
